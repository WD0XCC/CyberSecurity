## 1.1 算法介绍

RC4于1987年提出，和DES算法一样，是一种**对称加密算法**，也就是说使用的密钥为单钥（或称为私钥）。但不同于DES的是，RC4不是对明文进行分组处理，而是字节流的方式依次加密明文中的每一个字节，解密的时候也是依次对密文中的每一个字节进行解密。

**RC4**算法是一中称为密钥流的伪随机流，他与明文通过异或操作混合，以达到加密的目的。解密时与密文进行异或操作。

**RC4算法的特点：**RC4算法简单、高效，特别适合软件实现，加密速度比DES大约快10倍。而且密钥长度是可变的，可变范围为1-256字节(8-2048比特)，在如今技术支持的前提下，当密钥长度为128比特时，用暴力法搜索密钥已经不太可行，所以可以预见RC4的密钥范围任然可以在今后相当长的时间里抵御暴力搜索密钥的攻击。实际上，如今也没有找到对于128bit密钥长度的RC4[加密算法](https://so.csdn.net/so/search?q=加密算法&spm=1001.2101.3001.7020)的有效攻击方法。

## 1.2 算法原理

RCA密钥流由两部分组成：KSA和PRGA。

**KSA（the Key-Scheduling Algorithm）**

RC4首先使用密钥调度算法完成对大小为256字节的数组S的初始化及替换。再替换时使用密钥。其密钥长度一般取5~16字节，即40~128位。页可以更长，通常不超过256位。先用0~255初始化数组S，然后用密钥进行替换。



**PRGA（the Pseudo-Random Generation Algorithm)**

数组S在完成初始化之后，便不再使用输入的密钥流。密钥流的生成是从S[0]到S[255]的。对每个S[i],根据当前的S的值，将S[i]与S中的另一个字节置换。在S[255]完成转换后，操作仍重复执行。